{% extends "base.html" %}
{% block title %}Audit Log — Admin — {{ club.name if club else 'FleetNests' }}{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h5 class="fw-bold mb-0"><i class="bi bi-journal-text me-2 text-club-blue"></i>Audit Log</h5>
  <div>
    {% for d in [7, 30, 90] %}
    <a href="?days={{ d }}" class="btn btn-sm {% if days == d %}btn-club-blue{% else %}btn-outline-secondary{% endif %} me-1">{{ d }}d</a>
    {% endfor %}
  </div>
</div>
<div class="card border-0 shadow-sm">
  <div class="table-responsive">
    <table class="table table-sm table-hover align-middle mb-0">
      <thead class="table-light">
        <tr><th>When</th><th>User</th><th>Action</th><th>Detail</th></tr>
      </thead>
      <tbody>
        {% for e in entries %}
        <tr>
          <td class="text-muted small text-nowrap">{{ e.created_at.strftime('%b %d %I:%M %p') }} CT</td>
          <td class="small">{{ e.full_name or '—' }}</td>
          <td>
            {% set badge = {
              'reservation_created': 'bg-success',
              'reservation_cancelled': 'bg-danger',
              'user_created': 'bg-primary',
              'user_deactivated': 'bg-warning text-dark',
              'password_reset': 'bg-secondary',
              'blackout_created': 'bg-danger',
              'blackout_deleted': 'bg-secondary',
            } %}
            <span class="badge {{ badge.get(e.action, 'bg-secondary') }}">{{ e.action | replace('_', ' ') }}</span>
          </td>
          <td class="text-muted small">{{ e.detail or '' }}</td>
        </tr>
        {% else %}
        <tr><td colspan="4" class="text-center text-muted py-4">No log entries.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
