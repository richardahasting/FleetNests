{% extends "base.html" %}
{% block title %}Statements — {{ club.name if club else 'FleetNests' }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-md-8 col-lg-7">

    <h5 class="fw-bold mb-3"><i class="bi bi-file-earmark-pdf me-2 text-club-blue"></i>Monthly Statements</h5>

    <div class="card border-0 shadow-sm mb-4">
      <div class="card-header bg-light fw-semibold small text-muted">
        <i class="bi bi-upload me-1"></i>Upload New Statement
      </div>
      <div class="card-body p-4">
        <form method="post" enctype="multipart/form-data">
          <div class="mb-3">
            <label class="form-label" for="display_name">Statement Name</label>
            <input type="text" class="form-control" id="display_name" name="display_name"
                   placeholder="e.g. January 2026 Statement" maxlength="200" required>
          </div>
          <div class="mb-3">
            <label class="form-label" for="pdf_file">PDF File</label>
            <input type="file" class="form-control" id="pdf_file" name="pdf_file"
                   accept="application/pdf,.pdf" required>
            <div class="form-text">PDF only · max 20 MB</div>
          </div>
          <button type="submit" class="btn btn-club-blue">
            <i class="bi bi-upload me-1"></i>Upload
          </button>
        </form>
      </div>
    </div>

    {% if statements %}
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-light fw-semibold small text-muted">
        <i class="bi bi-list-ul me-1"></i>Uploaded Statements
      </div>
      <ul class="list-group list-group-flush">
        {% for s in statements %}
        <li class="list-group-item d-flex justify-content-between align-items-center py-3">
          <div>
            <div class="fw-semibold"><i class="bi bi-file-earmark-pdf text-danger me-2"></i>{{ s.display_name }}</div>
            <div class="text-muted small mt-1">
              {{ s.uploaded_at.strftime('%B %d, %Y') }}
              &nbsp;·&nbsp; {{ '%.1f'|format(s.file_size / 1024 / 1024) }} MB
            </div>
          </div>
          <div class="d-flex gap-2">
            <a href="{{ url_for('download_statement', stmt_id=s.id) }}"
               class="btn btn-sm btn-outline-secondary">
              <i class="bi bi-download"></i>
            </a>
            <form method="post"
                  onsubmit="return confirm('Delete {{ s.display_name }}?')">
              <input type="hidden" name="action" value="delete">
              <input type="hidden" name="stmt_id" value="{{ s.id }}">
              <button type="submit" class="btn btn-sm btn-outline-danger">
                <i class="bi bi-trash"></i>
              </button>
            </form>
          </div>
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

  </div>
</div>
{% endblock %}
